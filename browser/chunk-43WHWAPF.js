import{a as G}from"./chunk-KTISCEKV.js";import{a as L,b as O,c as U,d as A,e as w}from"./chunk-XYSLTE2R.js";import{e as V,g as $}from"./chunk-GFJW6R2J.js";import{$ as N,Ab as j,Ca as I,Fa as T,J as M,La as B,Ma as y,Na as P,T as u,Wa as i,Xa as r,Ya as g,_ as h,ab as H,bb as k,cb as C,db as S,eb as n,fb as F,ga as E,gb as l,jb as s,kb as m,l as D,p as c,pb as p,q as _,qb as R,sa as o}from"./chunk-ARZDUVSM.js";var v=class a{transform(t){if(t==null)return"-";let e=typeof t=="string"?parseFloat(t):t;return isNaN(e)?"-":e>=1e9?(e/1e9).toFixed(2)+"B":e>=1e6?(e/1e6).toFixed(2)+"M":e>=1e3?(e/1e3).toFixed(2)+"K":e.toFixed(0)}static \u0275fac=function(e){return new(e||a)};static \u0275pipe=T({name:"cryptoVolume",type:a,pure:!0})};function J(a,t){if(a&1&&(h(),g(0,"polyline",14)),a&2){let e=k(2);B("points",e.getChartPoints())("stroke",e.isPositive()?"#10b981":"#ef4444")}}function Q(a,t){if(a&1&&(i(0,"div",3)(1,"div",5)(2,"h1",6),n(3),s(4,"cryptoSymbol"),r(),i(5,"div",7)(6,"span",8),n(7),s(8,"cryptoPrice"),r(),i(9,"span",9),n(10),s(11,"cryptoPercent"),r()()(),i(12,"div",10)(13,"h3",11),n(14," Andamento Real-time "),r(),i(15,"div",12),h(),i(16,"svg",13),y(17,J,1,2,":svg:polyline",14),r()()(),N(),i(18,"div",15)(19,"div",10)(20,"div",16),n(21,"Massimo 24h"),r(),i(22,"div",17),n(23),s(24,"cryptoPrice"),r()(),i(25,"div",10)(26,"div",16),n(27,"Minimo 24h"),r(),i(28,"div",17),n(29),s(30,"cryptoPrice"),r()(),i(31,"div",10)(32,"div",16),n(33,"Volume 24h"),r(),i(34,"div",17),n(35),s(36,"cryptoVolume"),r()()(),i(37,"div",10)(38,"div",18),n(39,"Range giornaliero"),r(),i(40,"div",19),g(41,"div",20)(42,"div",21),r(),i(43,"div",22)(44,"span"),n(45),s(46,"cryptoPrice"),r(),i(47,"span"),n(48),s(49,"cryptoPrice"),r()()(),i(50,"div",10)(51,"h3",11),n(52," Dettagli "),r(),i(53,"div",23)(54,"div",24)(55,"span",25),n(56,"Simbolo"),r(),i(57,"span",26),n(58),r()(),i(59,"div",24)(60,"span",25),n(61,"Cambio 24h"),r(),i(62,"span",27),n(63),s(64,"cryptoPercent"),r()(),i(65,"div",28)(66,"span",25),n(67,"Ultimo aggiornamento"),r(),i(68,"span",26),n(69),r()()()()()),a&2){let e=k();o(3),l(" ",m(4,40,e.symbol())," "),o(4),l(" $",m(8,42,e.currentPrice())," "),o(2),S("bg-green-100",e.isPositive())("text-green-700",e.isPositive())("bg-red-100",e.isNegative())("text-red-700",e.isNegative())("dark:bg-green-900",e.isPositive())("dark:text-green-300",e.isPositive())("dark:bg-red-900",e.isNegative())("dark:text-red-300",e.isNegative()),o(),l(" ",m(11,44,e.priceChange())," "),o(7),P(e.priceHistory().length>1?17:-1),o(6),l(" $",m(24,46,e.highPrice())," "),o(6),l(" $",m(30,48,e.lowPrice())," "),o(6),l(" ",m(36,50,e.volume24h())," "),o(6),C("width",e.priceRange(),"%"),o(),C("left",e.priceRange(),"%"),o(3),l("$",m(46,52,e.lowPrice())),o(3),l("$",m(49,54,e.highPrice())),o(10),F(e.symbol()),o(4),S("text-green-600",e.isPositive())("text-red-600",e.isNegative())("dark:text-green-400",e.isPositive())("dark:text-red-400",e.isNegative()),o(),l(" ",m(64,56,e.priceChange())," "),o(6),l(" ",e.lastUpdate()," ")}}function W(a,t){a&1&&(i(0,"div",4),g(1,"div",29),i(2,"p",30),n(3,"Caricamento dati..."),r()())}var K=class a{binanceService=u(L);route=u(V);router=u($);symbol=w(this.route.paramMap.pipe(c(t=>t.get("symbol")||"")));priceHistory=E([]);lastUpdate=E(new Date().toLocaleTimeString("it-IT"));updateInterval;cryptoData=w(this.route.paramMap.pipe(c(t=>t.get("symbol")),M(t=>t?_([this.binanceService.connect(t),this.binanceService.getTicker(t)]).pipe(c(([e,d])=>({price:e,ticker:d,symbol:t}))):D(null))),{initialValue:null});currentPrice=p(()=>this.cryptoData()?.price);ticker=p(()=>this.cryptoData()?.ticker);priceChange=p(()=>{let t=this.ticker();return t?parseFloat(t.priceChangePercent):null});isPositive=p(()=>(this.priceChange()||0)>0);isNegative=p(()=>(this.priceChange()||0)<0);volume24h=p(()=>{let t=this.ticker();return t?parseFloat(t.volume):null});highPrice=p(()=>{let t=this.ticker();return t?parseFloat(t.highPrice):null});lowPrice=p(()=>{let t=this.ticker();return t?parseFloat(t.lowPrice):null});priceRange=p(()=>{let t=this.highPrice(),e=this.lowPrice(),d=this.currentPrice();return!t||!e||!d?0:(d-e)/(t-e)*100});constructor(){this.updateInterval=setInterval(()=>{this.lastUpdate.set(new Date().toLocaleTimeString("it-IT"))},1e3),R(()=>{let t=this.currentPrice();if(t&&t>0){let e=this.priceHistory();if((e.length>0?e[e.length-1].price:null)!==t){let x={price:t,timestamp:Date.now()},b=[...e,x].slice(-50);this.priceHistory.set(b)}}})}getChartPoints(){let t=this.priceHistory();if(t.length<2)return"";let e=t.map(f=>f.price),d=Math.min(...e),b=Math.max(...e)-d||1;return t.map((f,X)=>{let Y=X/(t.length-1)*500,q=100-(f.price-d)/b*80-10;return`${Y},${q}`}).join(" ")}goBack(){this.router.navigate([G.HOME])}ngOnDestroy(){this.updateInterval&&clearInterval(this.updateInterval);let t=this.symbol();t&&this.binanceService.disconnect(t)}static \u0275fac=function(e){return new(e||a)};static \u0275cmp=I({type:a,selectors:[["app-crypto-detail"]],decls:6,vars:1,consts:[[1,"flex","min-h-full","w-full","flex-col","items-center","justify-start","py-8"],[1,"w-full","max-w-5xl","space-y-6"],[1,"rounded-lg","border-2","border-slate-200","bg-white","px-6","py-2","font-semibold","transition-all","hover:border-blue-500","hover:text-blue-600","dark:border-slate-700","dark:bg-slate-800","dark:text-slate-100","dark:hover:border-blue-400","dark:hover:text-blue-400",3,"click"],[1,"space-y-6"],[1,"flex","flex-col","items-center","justify-center","py-20"],[1,"rounded-xl","border-2","border-slate-200","bg-white","p-8","dark:border-slate-700","dark:bg-slate-800"],[1,"mb-4","text-4xl","font-extrabold","text-slate-900","dark:text-slate-100"],[1,"flex","items-baseline","gap-4"],[1,"text-5xl","font-bold","text-slate-900","dark:text-slate-100"],[1,"rounded-lg","px-4","py-2","text-xl","font-semibold"],[1,"rounded-xl","border-2","border-slate-200","bg-white","p-6","dark:border-slate-700","dark:bg-slate-800"],[1,"mb-4","text-lg","font-semibold","text-slate-900","dark:text-slate-100"],[1,"h-40"],["viewBox","0 0 500 100",1,"h-full","w-full"],["fill","none","stroke-width","2"],[1,"grid","grid-cols-1","gap-4","md:grid-cols-3"],[1,"mb-2","text-sm","text-slate-600","dark:text-slate-400"],[1,"text-2xl","font-bold","text-slate-900","dark:text-slate-100"],[1,"mb-4","text-sm","text-slate-600","dark:text-slate-400"],[1,"relative","mb-2","h-2","rounded-full","bg-slate-200","dark:bg-slate-700"],[1,"absolute","h-full","rounded-full","bg-gradient-to-r","from-red-500","to-green-500","transition-all"],[1,"absolute","-top-1","h-4","w-4","rounded-full","border-4","border-white","bg-blue-600","shadow-lg","transition-all","dark:border-slate-800",2,"transform","translateX(-50%)"],[1,"flex","justify-between","text-sm","text-slate-600","dark:text-slate-400"],[1,"space-y-4"],[1,"flex","justify-between","border-b","border-slate-200","py-3","dark:border-slate-700"],[1,"text-slate-600","dark:text-slate-400"],[1,"font-semibold","text-slate-900","dark:text-slate-100"],[1,"font-semibold"],[1,"flex","justify-between","py-3"],[1,"mb-4","h-16","w-16","animate-spin","rounded-full","border-b-4","border-blue-600","dark:border-blue-400"],[1,"text-lg","text-slate-600","dark:text-slate-400"]],template:function(e,d){e&1&&(i(0,"div",0)(1,"div",1)(2,"button",2),H("click",function(){return d.goBack()}),n(3," \u2190 Indietro "),r(),y(4,Q,70,58,"div",3)(5,W,4,0,"div",4),r()()),e&2&&(o(4),P(d.currentPrice()!==void 0&&d.currentPrice()!==null&&d.ticker()?4:5))},dependencies:[j,O,U,A,v],encapsulation:2})};export{K as CryptoDetailComponent};
